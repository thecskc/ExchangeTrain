{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\santh\\\\WebstormProjects\\\\ExchangeTrain\\\\pages\\\\profile.js\";\nimport React, { Component } from \"react\";\nimport firebase from \"../components/firebase\";\nimport Router from 'next/router';\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from '@material-ui/core/Button';\nimport \"../styling/style.css\";\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      \"user\": null,\n      \"loaded\": false,\n      \"displayName\": \"\",\n      \"bio\": \"\",\n      \"coachcode\": \"\",\n      \"schoolcompany\": \"\",\n      \"location\": \"\",\n      \"isCoach\": false,\n      \"calendlylink\": \"\"\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.loadedProfile = this.loadedProfile.bind(this);\n    this.editProfile = this.editProfile.bind(this);\n    this.handleAccessCode = this.handleAccessCode.bind(this);\n  }\n\n  handleAccessCode() {\n    console.log(\"env code\");\n    console.log(process.env.COACH_CODE);\n\n    if (this.state.coachcode === process.env.COACH_CODE.toString()) {\n      this.setState({\n        \"coachcode\": this.state.coachcode,\n        \"isCoach\": true\n      });\n    } else {\n      this.setState({\n        \"coachcode\": this.state.coachcode,\n        \"isCoach\": false\n      });\n    }\n  }\n\n  handleChange(event) {\n    event.preventDefault();\n    const nameVal = event.target.name;\n    const valueVal = event.target.value;\n    this.setState({\n      [nameVal]: valueVal\n    });\n  }\n\n  loadedProfile(inputMap) {\n    const stateMap = {};\n\n    for (const key in inputMap) {\n      if (inputMap.hasOwnProperty(key)) {\n        stateMap[key] = inputMap[key];\n      }\n    }\n\n    console.log(\"loading profile setting state\");\n    console.log(stateMap);\n    this.setState(stateMap);\n  }\n\n  settingData() {\n    const setMap = {\n      \"displayName\": this.state.displayName,\n      \"bio\": this.state.bio,\n      \"location\": this.state.location,\n      \"schoolcompany\": this.state.schoolcompany\n    };\n\n    if (this.state.isCoach) {\n      setMap[\"isCoach\"] = true;\n      setMap[\"coachcode\"] = this.state.coachcode;\n      setMap[\"calendlylink\"] = this.state.calendlylink;\n    }\n\n    return setMap;\n  }\n\n  editProfile(event) {\n    event.preventDefault();\n    this.handleAccessCode();\n    const dbRef = firebase.firestore().collection(\"Profiles\").doc(this.state.user.uid).set(this.settingData()).then(() => {\n      console.log(\"written\");\n      const userProfile = {\n        \"user\": this.state.user,\n        \"displayName\": this.state.displayName,\n        \"bio\": this.state.bio,\n        \"location\": this.state.location,\n        \"schoolcompany\": this.state.schoolcompany\n      };\n\n      if (this.state.isCoach) {\n        userProfile[\"isCoach\"] = true;\n        userProfile[\"coachcode\"] = this.state.coachcode;\n        userProfile[\"calendlylink\"] = this.state.calendlylink;\n      }\n\n      this.loadedProfile(userProfile);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  getUserProfile(user) {\n    const db = firebase.firestore();\n    const docRef = db.collection(\"Profiles\").doc(user.uid);\n    docRef.get().then(doc => {\n      if (doc.exists) {\n        console.log(\"querying doc\");\n        console.log(doc.data());\n        const userProfile = {\n          \"user\": user,\n          \"displayName\": doc.data().displayName,\n          \"bio\": doc.data().bio,\n          \"location\": doc.data().location,\n          \"schoolcompany\": doc.data().schoolcompany,\n          \"loaded\": true\n        };\n\n        if (doc.data().isCoach) {\n          userProfile[\"isCoach\"] = true;\n          userProfile[\"coachcode\"] = doc.data().coachcode;\n          userProfile[\"calendlylink\"] = doc.data().calendlylink;\n        }\n\n        this.loadedProfile(userProfile);\n      } else {\n        console.log(\"no document\");\n        const userProfile = {\n          \"user\": user,\n          \"displayName\": \"\",\n          \"bio\": \"\",\n          \"location\": \"\",\n          \"schoolcompany\": \"\",\n          \"loaded\": true\n        };\n        this.loadedProfile(userProfile);\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentDidMount() {\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        console.log(\"user\");\n        console.log(user);\n        this.getUserProfile(user);\n      } else {\n        this.setState({\n          \"loaded\": true,\n          \"user\": null\n        });\n      }\n    });\n  }\n\n  render() {\n    if (this.state.loaded) {\n      if (this.state.user) {\n        return React.createElement(\"div\", {\n          className: \"container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, React.createElement(\"form\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          name: \"displayName\",\n          placeholder: \"Enter Name\",\n          value: this.state.displayName,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          name: \"schoolcompany\",\n          placeholder: \"School/Company\",\n          value: this.state.schoolcompany,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          name: \"location\",\n          placeholder: \"Location\",\n          value: this.state.location,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          name: \"bio\",\n          placeholder: \"Bio\",\n          value: this.state.bio,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          name: \"coachcode\",\n          placeholder: \"Coach Access Code\",\n          value: this.state.coachcode,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 239\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        }), (() => {\n          if (this.state.isCoach) {\n            return React.createElement(\"input\", {\n              name: \"calendlylink\",\n              placeholder: \"Enter your calendly link\",\n              value: this.state.calendlylink,\n              onChange: this.handleChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 253\n              },\n              __self: this\n            });\n          }\n        })(), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          onClick: this.editProfile,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }, \"Edit\")));\n      } else {\n        return React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 279\n          },\n          __self: this\n        }, \"Not logged in\");\n      }\n    } else {\n      return React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, \"Loading\");\n    }\n  }\n\n}\n\nexport default Profile;","map":{"version":3,"sources":["C:\\Users\\santh\\WebstormProjects\\ExchangeTrain\\pages\\profile.js"],"names":["React","Component","firebase","Router","TextField","Button","Profile","constructor","props","state","handleChange","bind","loadedProfile","editProfile","handleAccessCode","console","log","process","env","COACH_CODE","coachcode","toString","setState","event","preventDefault","nameVal","target","name","valueVal","value","inputMap","stateMap","key","hasOwnProperty","settingData","setMap","displayName","bio","location","schoolcompany","isCoach","calendlylink","dbRef","firestore","collection","doc","user","uid","set","then","userProfile","catch","error","getUserProfile","db","docRef","get","exists","data","componentDidMount","auth","onAuthStateChanged","render","loaded"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport firebase from \"../components/firebase\";\r\nimport Router from 'next/router';\r\nimport TextField from \"@material-ui/core/TextField\"\r\nimport Button from '@material-ui/core/Button';\r\nimport \"../styling/style.css\"\r\n\r\n\r\nclass Profile extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            \"user\": null,\r\n            \"loaded\": false,\r\n            \"displayName\": \"\",\r\n            \"bio\": \"\",\r\n            \"coachcode\": \"\",\r\n            \"schoolcompany\": \"\",\r\n            \"location\": \"\",\r\n            \"isCoach\": false,\r\n            \"calendlylink\": \"\"\r\n        };\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.loadedProfile = this.loadedProfile.bind(this);\r\n        this.editProfile = this.editProfile.bind(this);\r\n        this.handleAccessCode = this.handleAccessCode.bind(this);\r\n\r\n    }\r\n\r\n\r\n    handleAccessCode() {\r\n\r\n\r\n        console.log(\"env code\");\r\n        console.log(process.env.COACH_CODE);\r\n\r\n        if (this.state.coachcode === process.env.COACH_CODE.toString()) {\r\n            this.setState({\"coachcode\": this.state.coachcode, \"isCoach\": true})\r\n        }\r\n        else {\r\n            this.setState({\"coachcode\": this.state.coachcode, \"isCoach\": false})\r\n        }\r\n\r\n\r\n    }\r\n\r\n    handleChange(event) {\r\n        event.preventDefault();\r\n        const nameVal = event.target.name;\r\n        const valueVal = event.target.value;\r\n        this.setState({[nameVal]: valueVal})\r\n    }\r\n\r\n    loadedProfile(inputMap) {\r\n\r\n\r\n        const stateMap = {};\r\n\r\n        for (const key in inputMap) {\r\n\r\n            if (inputMap.hasOwnProperty(key)) {\r\n                stateMap[key] = inputMap[key];\r\n            }\r\n        }\r\n\r\n        console.log(\"loading profile setting state\");\r\n\r\n        console.log(stateMap);\r\n        this.setState(\r\n            stateMap\r\n        );\r\n\r\n    }\r\n\r\n    settingData() {\r\n\r\n\r\n        const setMap = {\r\n            \"displayName\": this.state.displayName,\r\n            \"bio\": this.state.bio,\r\n            \"location\": this.state.location,\r\n            \"schoolcompany\": this.state.schoolcompany\r\n        };\r\n\r\n        if (this.state.isCoach) {\r\n            setMap[\"isCoach\"] = true;\r\n            setMap[\"coachcode\"] = this.state.coachcode;\r\n            setMap[\"calendlylink\"] = this.state.calendlylink;\r\n        }\r\n\r\n        return setMap;\r\n    }\r\n\r\n    editProfile(event) {\r\n        event.preventDefault();\r\n\r\n\r\n        this.handleAccessCode();\r\n\r\n        const dbRef = firebase.firestore().collection(\"Profiles\").doc(this.state.user.uid).set(this.settingData()).then(() => {\r\n            console.log(\"written\");\r\n            const userProfile = {\r\n                \"user\": this.state.user,\r\n                \"displayName\": this.state.displayName,\r\n                \"bio\": this.state.bio,\r\n                \"location\": this.state.location,\r\n                \"schoolcompany\": this.state.schoolcompany\r\n\r\n            };\r\n            if (this.state.isCoach) {\r\n                userProfile[\"isCoach\"] = true;\r\n                userProfile[\"coachcode\"] = this.state.coachcode;\r\n                userProfile[\"calendlylink\"] = this.state.calendlylink;\r\n            }\r\n            this.loadedProfile(userProfile);\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n\r\n        });\r\n\r\n    }\r\n\r\n    getUserProfile(user) {\r\n        const db = firebase.firestore();\r\n        const docRef = db.collection(\"Profiles\").doc(user.uid);\r\n        docRef.get().then((doc) => {\r\n            if (doc.exists) {\r\n                console.log(\"querying doc\");\r\n                console.log(doc.data());\r\n\r\n                const userProfile = {\r\n                    \"user\": user,\r\n                    \"displayName\": doc.data().displayName,\r\n                    \"bio\": doc.data().bio,\r\n                    \"location\": doc.data().location,\r\n                    \"schoolcompany\": doc.data().schoolcompany,\r\n                    \"loaded\": true\r\n                };\r\n\r\n                if (doc.data().isCoach) {\r\n                    userProfile[\"isCoach\"] = true;\r\n                    userProfile[\"coachcode\"] = doc.data().coachcode;\r\n                    userProfile[\"calendlylink\"] = doc.data().calendlylink;\r\n                }\r\n                this.loadedProfile(userProfile);\r\n\r\n            }\r\n            else {\r\n                console.log(\"no document\");\r\n                const userProfile = {\r\n                    \"user\": user,\r\n                    \"displayName\": \"\",\r\n                    \"bio\": \"\",\r\n                    \"location\": \"\",\r\n                    \"schoolcompany\": \"\",\r\n                    \"loaded\": true\r\n                };\r\n                this.loadedProfile(userProfile)\r\n\r\n            }\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n        })\r\n\r\n\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n        firebase.auth().onAuthStateChanged((user) => {\r\n\r\n            if (user) {\r\n                console.log(\"user\");\r\n                console.log(user);\r\n                this.getUserProfile(user);\r\n\r\n            }\r\n            else {\r\n                this.setState({\"loaded\": true, \"user\": null});\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        if (this.state.loaded) {\r\n\r\n            if (this.state.user) {\r\n                return (\r\n\r\n                    <div className=\"container\">\r\n                        <form>\r\n\r\n\r\n                            <input\r\n\r\n                                name=\"displayName\"\r\n                                placeholder=\"Enter Name\"\r\n                                value={this.state.displayName}\r\n                                onChange={this.handleChange}\r\n                            />\r\n                            <br/><br/>\r\n\r\n                            <input\r\n                                name=\"schoolcompany\"\r\n                                placeholder=\"School/Company\"\r\n                                value={this.state.schoolcompany}\r\n                                onChange={this.handleChange}\r\n                            />\r\n\r\n                            <br/><br/>\r\n\r\n                            <input\r\n                                name=\"location\"\r\n                                placeholder=\"Location\"\r\n                                value={this.state.location}\r\n                                onChange={this.handleChange}\r\n                            />\r\n\r\n\r\n                            <br/><br/>\r\n\r\n\r\n                            <input\r\n\r\n                                name=\"bio\"\r\n                                placeholder=\"Bio\"\r\n                                value={this.state.bio}\r\n                                onChange={this.handleChange}\r\n                            />\r\n\r\n\r\n                            <br/><br/>\r\n\r\n                            <input\r\n                                name=\"coachcode\"\r\n                                placeholder=\"Coach Access Code\"\r\n                                value={this.state.coachcode}\r\n                                onChange={this.handleChange}\r\n                            />\r\n\r\n                            <br/><br/>\r\n\r\n                            {(() => {\r\n\r\n                                if (this.state.isCoach) {\r\n                                    return (\r\n\r\n                                        <input\r\n                                            name=\"calendlylink\"\r\n                                            placeholder=\"Enter your calendly link\"\r\n                                            value={this.state.calendlylink}\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n                                    )\r\n                                }\r\n\r\n\r\n                            })()}\r\n\r\n\r\n                            <br/><br/>\r\n\r\n                            <button onClick={this.editProfile}>\r\n                                Edit\r\n                            </button>\r\n\r\n                        </form>\r\n                    </div>\r\n\r\n\r\n                );\r\n            }\r\n            else {\r\n                return (<h1>Not logged in</h1>)\r\n\r\n            }\r\n        }\r\n        else {\r\n            return (<h1>Loading</h1>)\r\n        }\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}