{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\santh\\\\WebstormProjects\\\\ExchangeTrain\\\\pages\\\\profile.js\";\nimport React, { Component } from \"react\";\nimport firebase from \"../components/firebase\";\nimport Router from 'next/router';\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from '@material-ui/core/Button';\nimport \"../styling/style.css\";\nimport Navbar from \"../components/navbar\";\n\nvar Profile =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Profile, _Component);\n\n  function Profile(props) {\n    var _this;\n\n    _classCallCheck(this, Profile);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Profile).call(this, props));\n    _this.state = {\n      \"user\": null,\n      \"loaded\": false,\n      \"displayName\": \"\",\n      \"bio\": \"\",\n      \"coachcode\": \"\",\n      \"schoolcompany\": \"\",\n      \"location\": \"\",\n      \"isCoach\": false,\n      \"calendlylink\": \"\"\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.loadedProfile = _this.loadedProfile.bind(_assertThisInitialized(_this));\n    _this.editProfile = _this.editProfile.bind(_assertThisInitialized(_this));\n    _this.handleAccessCode = _this.handleAccessCode.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Profile, [{\n    key: \"handleAccessCode\",\n    value: function handleAccessCode() {\n      console.log(\"env code\");\n      console.log(process.env.COACH_CODE);\n\n      if (this.state.coachcode === process.env.COACH_CODE.toString()) {\n        this.setState({\n          \"coachcode\": this.state.coachcode,\n          \"isCoach\": true\n        });\n      } else {\n        this.setState({\n          \"coachcode\": this.state.coachcode,\n          \"isCoach\": false\n        });\n      }\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      event.preventDefault();\n      var nameVal = event.target.name;\n      var valueVal = event.target.value;\n      this.setState(_defineProperty({}, nameVal, valueVal));\n    }\n  }, {\n    key: \"loadedProfile\",\n    value: function loadedProfile(inputMap) {\n      var stateMap = {};\n\n      for (var key in inputMap) {\n        if (inputMap.hasOwnProperty(key)) {\n          stateMap[key] = inputMap[key];\n        }\n      }\n\n      console.log(\"loading profile setting state\");\n      console.log(stateMap);\n      this.setState(stateMap);\n    }\n  }, {\n    key: \"settingData\",\n    value: function settingData() {\n      var setMap = {\n        \"displayName\": this.state.displayName,\n        \"bio\": this.state.bio,\n        \"location\": this.state.location,\n        \"schoolcompany\": this.state.schoolcompany\n      };\n\n      if (this.state.isCoach) {\n        setMap[\"isCoach\"] = true;\n        setMap[\"coachcode\"] = this.state.coachcode;\n        setMap[\"calendlylink\"] = this.state.calendlylink;\n      }\n\n      return setMap;\n    }\n  }, {\n    key: \"editProfile\",\n    value: function editProfile(event) {\n      var _this2 = this;\n\n      event.preventDefault();\n      this.handleAccessCode();\n      var dbRef = firebase.firestore().collection(\"Profiles\").doc(this.state.user.uid).set(this.settingData()).then(function () {\n        console.log(\"written\");\n        var userProfile = {\n          \"user\": _this2.state.user,\n          \"displayName\": _this2.state.displayName,\n          \"bio\": _this2.state.bio,\n          \"location\": _this2.state.location,\n          \"schoolcompany\": _this2.state.schoolcompany\n        };\n\n        if (_this2.state.isCoach) {\n          userProfile[\"isCoach\"] = true;\n          userProfile[\"coachcode\"] = _this2.state.coachcode;\n          userProfile[\"calendlylink\"] = _this2.state.calendlylink;\n        }\n\n        _this2.loadedProfile(userProfile);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"getUserProfile\",\n    value: function getUserProfile(user) {\n      var _this3 = this;\n\n      var db = firebase.firestore();\n      var docRef = db.collection(\"Profiles\").doc(user.uid);\n      docRef.get().then(function (doc) {\n        if (doc.exists) {\n          console.log(\"querying doc\");\n          console.log(doc.data());\n          var userProfile = {\n            \"user\": user,\n            \"displayName\": doc.data().displayName,\n            \"bio\": doc.data().bio,\n            \"location\": doc.data().location,\n            \"schoolcompany\": doc.data().schoolcompany,\n            \"loaded\": true\n          };\n\n          if (doc.data().isCoach) {\n            userProfile[\"isCoach\"] = true;\n            userProfile[\"coachcode\"] = doc.data().coachcode;\n            userProfile[\"calendlylink\"] = doc.data().calendlylink;\n          }\n\n          _this3.loadedProfile(userProfile);\n        } else {\n          console.log(\"no document\");\n          var _userProfile = {\n            \"user\": user,\n            \"displayName\": \"\",\n            \"bio\": \"\",\n            \"location\": \"\",\n            \"schoolcompany\": \"\",\n            \"loaded\": true\n          };\n\n          _this3.loadedProfile(_userProfile);\n        }\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this4 = this;\n\n      firebase.auth().onAuthStateChanged(function (user) {\n        if (user) {\n          console.log(\"user\");\n          console.log(user);\n\n          _this4.getUserProfile(user);\n        } else {\n          _this4.setState({\n            \"loaded\": true,\n            \"user\": null\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      if (this.state.loaded) {\n        if (this.state.user) {\n          return React.createElement(React.Fragment, null, React.createElement(Navbar, {\n            user: this.state.user,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 199\n            },\n            __self: this\n          }), React.createElement(\"div\", {\n            className: \"container\",\n            style: {\n              \"justify-content\": \"center\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 201\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"row\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 203\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"page-heading\",\n            style: {\n              \"align-self\": \"center\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 204\n            },\n            __self: this\n          }, \"Fill Out Your Profile\")), React.createElement(\"div\", {\n            className: \"card-section\",\n            style: {\n              \"align-self\": \"center\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 207\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"card\",\n            style: {\n              \"min-width\": \"50vw\",\n              \"min-height\": \"70vh\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 208\n            },\n            __self: this\n          }, React.createElement(\"form\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 209\n            },\n            __self: this\n          }, React.createElement(TextField, {\n            name: \"displayName\",\n            placeholder: \"Enter Name\",\n            value: this.state.displayName,\n            onChange: this.handleChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 212\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 219\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 219\n            },\n            __self: this\n          }), React.createElement(TextField, {\n            name: \"schoolcompany\",\n            placeholder: \"School/Company\",\n            value: this.state.schoolcompany,\n            onChange: this.handleChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 221\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 228\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 228\n            },\n            __self: this\n          }), React.createElement(TextField, {\n            name: \"location\",\n            placeholder: \"Location\",\n            value: this.state.location,\n            onChange: this.handleChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 230\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 238\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 238\n            },\n            __self: this\n          }), React.createElement(TextField, {\n            name: \"bio\",\n            placeholder: \"Bio\",\n            value: this.state.bio,\n            onChange: this.handleChange,\n            multiline: true,\n            rows: \"4\",\n            rowsMax: \"7\",\n            style: {\n              width: \"100%\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 241\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 254\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 254\n            },\n            __self: this\n          }), React.createElement(TextField, {\n            name: \"coachcode\",\n            placeholder: \"Coach Access Code\",\n            value: this.state.coachcode,\n            onChange: this.handleChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 256\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263\n            },\n            __self: this\n          }), function () {\n            if (_this5.state.isCoach) {\n              return React.createElement(TextField, {\n                name: \"calendlylink\",\n                placeholder: \"Enter your calendly link\",\n                value: _this5.state.calendlylink,\n                onChange: _this5.handleChange,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 270\n                },\n                __self: this\n              });\n            }\n          }(), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 283\n            },\n            __self: this\n          }), React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 283\n            },\n            __self: this\n          }), React.createElement(Button, {\n            color: \"primary\",\n            variant: \"contained\",\n            onClick: this.editProfile,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 286\n            },\n            __self: this\n          }, \"Save\"))))));\n        } else {\n          return React.createElement(\"h1\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 301\n            },\n            __self: this\n          }, \"Not logged in\");\n        }\n      } else {\n        return React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 306\n          },\n          __self: this\n        }, \"Loading\");\n      }\n    }\n  }]);\n\n  return Profile;\n}(Component);\n\nexport default Profile;","map":{"version":3,"sources":["C:\\Users\\santh\\WebstormProjects\\ExchangeTrain\\pages\\profile.js"],"names":["React","Component","firebase","Router","TextField","Button","Navbar","Profile","props","state","handleChange","bind","loadedProfile","editProfile","handleAccessCode","console","log","process","env","COACH_CODE","coachcode","toString","setState","event","preventDefault","nameVal","target","name","valueVal","value","inputMap","stateMap","key","hasOwnProperty","setMap","displayName","bio","location","schoolcompany","isCoach","calendlylink","dbRef","firestore","collection","doc","user","uid","set","settingData","then","userProfile","error","db","docRef","get","exists","data","auth","onAuthStateChanged","getUserProfile","loaded","width"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport firebase from \"../components/firebase\";\r\nimport Router from 'next/router';\r\nimport TextField from \"@material-ui/core/TextField\"\r\nimport Button from '@material-ui/core/Button';\r\nimport \"../styling/style.css\"\r\nimport Navbar from \"../components/navbar\";\r\n\r\n\r\n\r\n\r\nclass Profile extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            \"user\": null,\r\n            \"loaded\": false,\r\n            \"displayName\": \"\",\r\n            \"bio\": \"\",\r\n            \"coachcode\": \"\",\r\n            \"schoolcompany\": \"\",\r\n            \"location\": \"\",\r\n            \"isCoach\": false,\r\n            \"calendlylink\": \"\"\r\n        };\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.loadedProfile = this.loadedProfile.bind(this);\r\n        this.editProfile = this.editProfile.bind(this);\r\n        this.handleAccessCode = this.handleAccessCode.bind(this);\r\n\r\n    }\r\n\r\n\r\n    handleAccessCode() {\r\n\r\n\r\n        console.log(\"env code\");\r\n        console.log(process.env.COACH_CODE);\r\n\r\n        if (this.state.coachcode === process.env.COACH_CODE.toString()) {\r\n            this.setState({\"coachcode\": this.state.coachcode, \"isCoach\": true})\r\n        }\r\n        else {\r\n            this.setState({\"coachcode\": this.state.coachcode, \"isCoach\": false})\r\n        }\r\n\r\n\r\n    }\r\n\r\n    handleChange(event) {\r\n        event.preventDefault();\r\n        const nameVal = event.target.name;\r\n        const valueVal = event.target.value;\r\n        this.setState({[nameVal]: valueVal})\r\n    }\r\n\r\n    loadedProfile(inputMap) {\r\n\r\n\r\n        const stateMap = {};\r\n\r\n        for (const key in inputMap) {\r\n\r\n            if (inputMap.hasOwnProperty(key)) {\r\n                stateMap[key] = inputMap[key];\r\n            }\r\n        }\r\n\r\n        console.log(\"loading profile setting state\");\r\n\r\n        console.log(stateMap);\r\n        this.setState(\r\n            stateMap\r\n        );\r\n\r\n    }\r\n\r\n    settingData() {\r\n\r\n\r\n        const setMap = {\r\n            \"displayName\": this.state.displayName,\r\n            \"bio\": this.state.bio,\r\n            \"location\": this.state.location,\r\n            \"schoolcompany\": this.state.schoolcompany\r\n        };\r\n\r\n        if (this.state.isCoach) {\r\n            setMap[\"isCoach\"] = true;\r\n            setMap[\"coachcode\"] = this.state.coachcode;\r\n            setMap[\"calendlylink\"] = this.state.calendlylink;\r\n        }\r\n\r\n        return setMap;\r\n    }\r\n\r\n    editProfile(event) {\r\n        event.preventDefault();\r\n\r\n\r\n        this.handleAccessCode();\r\n\r\n        const dbRef = firebase.firestore().collection(\"Profiles\").doc(this.state.user.uid).set(this.settingData()).then(() => {\r\n            console.log(\"written\");\r\n            const userProfile = {\r\n                \"user\": this.state.user,\r\n                \"displayName\": this.state.displayName,\r\n                \"bio\": this.state.bio,\r\n                \"location\": this.state.location,\r\n                \"schoolcompany\": this.state.schoolcompany\r\n\r\n            };\r\n            if (this.state.isCoach) {\r\n                userProfile[\"isCoach\"] = true;\r\n                userProfile[\"coachcode\"] = this.state.coachcode;\r\n                userProfile[\"calendlylink\"] = this.state.calendlylink;\r\n            }\r\n            this.loadedProfile(userProfile);\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n\r\n        });\r\n\r\n    }\r\n\r\n    getUserProfile(user) {\r\n        const db = firebase.firestore();\r\n        const docRef = db.collection(\"Profiles\").doc(user.uid);\r\n        docRef.get().then((doc) => {\r\n            if (doc.exists) {\r\n                console.log(\"querying doc\");\r\n                console.log(doc.data());\r\n\r\n                const userProfile = {\r\n                    \"user\": user,\r\n                    \"displayName\": doc.data().displayName,\r\n                    \"bio\": doc.data().bio,\r\n                    \"location\": doc.data().location,\r\n                    \"schoolcompany\": doc.data().schoolcompany,\r\n                    \"loaded\": true\r\n                };\r\n\r\n                if (doc.data().isCoach) {\r\n                    userProfile[\"isCoach\"] = true;\r\n                    userProfile[\"coachcode\"] = doc.data().coachcode;\r\n                    userProfile[\"calendlylink\"] = doc.data().calendlylink;\r\n                }\r\n                this.loadedProfile(userProfile);\r\n\r\n            }\r\n            else {\r\n                console.log(\"no document\");\r\n                const userProfile = {\r\n                    \"user\": user,\r\n                    \"displayName\": \"\",\r\n                    \"bio\": \"\",\r\n                    \"location\": \"\",\r\n                    \"schoolcompany\": \"\",\r\n                    \"loaded\": true\r\n                };\r\n                this.loadedProfile(userProfile)\r\n\r\n            }\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n        })\r\n\r\n\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n        firebase.auth().onAuthStateChanged((user) => {\r\n\r\n            if (user) {\r\n                console.log(\"user\");\r\n                console.log(user);\r\n                this.getUserProfile(user);\r\n\r\n            }\r\n            else {\r\n                this.setState({\"loaded\": true, \"user\": null});\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        if (this.state.loaded) {\r\n\r\n            if (this.state.user) {\r\n                return (\r\n\r\n                    <>\r\n                        <Navbar user={this.state.user}/>\r\n\r\n                        <div className=\"container\" style={{\"justify-content\": \"center\"}}>\r\n\r\n                            <div className=\"row\">\r\n                            <div className=\"page-heading\" style={{\"align-self\": \"center\"}}>Fill Out Your Profile</div>\r\n                            </div>\r\n                            \r\n                            <div className=\"card-section\" style={{\"align-self\": \"center\"}}>\r\n                                <div className=\"card\" style={{\"min-width\":\"50vw\",\"min-height\":\"70vh\"}}>\r\n                                    <form>\r\n\r\n\r\n                                        <TextField\r\n\r\n                                            name=\"displayName\"\r\n                                            placeholder=\"Enter Name\"\r\n                                            value={this.state.displayName}\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n                                        <br/><br/>\r\n\r\n                                        <TextField\r\n                                            name=\"schoolcompany\"\r\n                                            placeholder=\"School/Company\"\r\n                                            value={this.state.schoolcompany}\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n\r\n                                        <br/><br/>\r\n\r\n                                        <TextField\r\n                                            name=\"location\"\r\n                                            placeholder=\"Location\"\r\n                                            value={this.state.location}\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n\r\n\r\n                                        <br/><br/>\r\n\r\n\r\n                                        <TextField\r\n\r\n                                            name=\"bio\"\r\n                                            placeholder=\"Bio\"\r\n                                            value={this.state.bio}\r\n                                            onChange={this.handleChange}\r\n                                            multiline={true}\r\n                                            rows=\"4\"\r\n                                            rowsMax=\"7\"\r\n                                            style={{width:\"100%\"}}\r\n                                        />\r\n\r\n\r\n                                        <br/><br/>\r\n\r\n                                        <TextField\r\n                                            name=\"coachcode\"\r\n                                            placeholder=\"Coach Access Code\"\r\n                                            value={this.state.coachcode}\r\n                                            onChange={this.handleChange}\r\n                                        />\r\n\r\n                                        <br/><br/>\r\n\r\n                                        {(() => {\r\n\r\n                                            if (this.state.isCoach) {\r\n                                                return (\r\n\r\n                                                    <TextField\r\n                                                        name=\"calendlylink\"\r\n                                                        placeholder=\"Enter your calendly link\"\r\n                                                        value={this.state.calendlylink}\r\n                                                        onChange={this.handleChange}\r\n                                                    />\r\n                                                )\r\n                                            }\r\n\r\n\r\n                                        })()}\r\n\r\n\r\n                                        <br/><br/>\r\n\r\n\r\n                                        <Button color=\"primary\" variant=\"contained\" onClick={this.editProfile}>\r\n                                            Save\r\n                                        </Button>\r\n\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </>\r\n\r\n\r\n                );\r\n            }\r\n            else {\r\n                return (<h1>Not logged in</h1>)\r\n\r\n            }\r\n        }\r\n        else {\r\n            return (<h1>Loading</h1>)\r\n        }\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}